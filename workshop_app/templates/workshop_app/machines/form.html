{% extends 'workshop_app/base.html' %}

{% block title %}{{ title }} | Workshop Management System{% endblock %}

{% block content %}
    <div style="margin-bottom: 1rem;">
        <a href="{% if is_new %}{% url 'workshop_app:machine_list' %}{% else %}{% url 'workshop_app:machine_detail' machine.machine_id %}{% endif %}" class="btn btn-secondary">← Back</a>
    </div>
    
    <h2>{{ title }}</h2>
    
    <div style="max-width: 800px; margin: 0 auto;">
        {% if messages %}
            <div style="margin-bottom: 1rem;">
                {% for message in messages %}
                    <div style="padding: 0.5rem 1rem; background-color: {% if message.tags == 'success' %}#d4edda{% else %}#f8d7da{% endif %}; border-radius: 4px;">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
        
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 300px;">
                    <h3>Basic Information</h3>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.machine_id.id_for_label }}">Machine ID:</label>
                        {{ form.machine_id }}
                        {% if form.machine_id.help_text %}
                            <div style="font-size: 0.8rem; color: #666;">{{ form.machine_id.help_text }}</div>
                        {% endif %}
                        {% if form.machine_id.errors %}
                            <div style="color: red;">{{ form.machine_id.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.name.id_for_label }}">Machine Name:</label>
                        {{ form.name }}
                        {% if form.name.errors %}
                            <div style="color: red;">{{ form.name.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.machine_type.id_for_label }}">Machine Type:</label>
                        {{ form.machine_type }}
                        {% if form.machine_type.errors %}
                            <div style="color: red;">{{ form.machine_type.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.manufacturer.id_for_label }}">Manufacturer:</label>
                        {{ form.manufacturer }}
                        {% if form.manufacturer.errors %}
                            <div style="color: red;">{{ form.manufacturer.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.model_number.id_for_label }}">Model Number:</label>
                        {{ form.model_number }}
                        {% if form.model_number.errors %}
                            <div style="color: red;">{{ form.model_number.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.serial_number.id_for_label }}">Serial Number:</label>
                        {{ form.serial_number }}
                        {% if form.serial_number.help_text %}
                            <div style="font-size: 0.8rem; color: #666;">{{ form.serial_number.help_text }}</div>
                        {% endif %}
                        {% if form.serial_number.errors %}
                            <div style="color: red;">{{ form.serial_number.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.location_in_workshop.id_for_label }}">Location in Workshop:</label>
                        {{ form.location_in_workshop }}
                        {% if form.location_in_workshop.errors %}
                            <div style="color: red;">{{ form.location_in_workshop.errors }}</div>
                        {% endif %}
                    </div>
                </div>
                
                <div style="flex: 1; min-width: 300px;">
                    <h3>Purchase Information</h3>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.purchase_date.id_for_label }}">Purchase Date:</label>
                        {{ form.purchase_date }}
                        {% if form.purchase_date.errors %}
                            <div style="color: red;">{{ form.purchase_date.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.purchase_price.id_for_label }}">Purchase Price:</label>
                        {{ form.purchase_price }}
                        {% if form.purchase_price.errors %}
                            <div style="color: red;">{{ form.purchase_price.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.supplier.id_for_label }}">Supplier:</label>
                        {{ form.supplier }}
                        {% if form.supplier.errors %}
                            <div style="color: red;">{{ form.supplier.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.warranty_end_date.id_for_label }}">Warranty End Date:</label>
                        {{ form.warranty_end_date }}
                        {% if form.warranty_end_date.errors %}
                            <div style="color: red;">{{ form.warranty_end_date.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <h3>Status</h3>
                    
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.status.id_for_label }}">Current Status:</label>
                        {{ form.status }}
                        {% if form.status.errors %}
                            <div style="color: red;">{{ form.status.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <h3>Technical Specifications</h3>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 300px;">
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.working_area.id_for_label }}">Working Area:</label>
                        {{ form.working_area }}
                        {% if form.working_area.errors %}
                            <div style="color: red;">{{ form.working_area.errors }}</div>
                        {% endif %}
                    </div>
                </div>
                
                <div style="flex: 1; min-width: 300px;">
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.power_requirements.id_for_label }}">Power Requirements:</label>
                        {{ form.power_requirements }}
                        {% if form.power_requirements.errors %}
                            <div style="color: red;">{{ form.power_requirements.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 300px;">
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.maximum_work_speed.id_for_label }}">Maximum Work Speed:</label>
                        {{ form.maximum_work_speed }}
                        {% if form.maximum_work_speed.errors %}
                            <div style="color: red;">{{ form.maximum_work_speed.errors }}</div>
                        {% endif %}
                    </div>
                </div>
                
                <div style="flex: 1; min-width: 300px;">
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.precision.id_for_label }}">Precision:</label>
                        {{ form.precision }}
                        {% if form.precision.errors %}
                            <div style="color: red;">{{ form.precision.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <h3>Operational Costs</h3>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 200px;">
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.hourly_rate.id_for_label }}">Hourly Rate (€):</label>
                        {{ form.hourly_rate }}
                        {% if form.hourly_rate.errors %}
                            <div style="color: red;">{{ form.hourly_rate.errors }}</div>
                        {% endif %}
                    </div>
                </div>
                
                <div style="flex: 1; min-width: 200px;">
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.setup_time.id_for_label }}">Setup Time (minutes):</label>
                        {{ form.setup_time }}
                        {% if form.setup_time.errors %}
                            <div style="color: red;">{{ form.setup_time.errors }}</div>
                        {% endif %}
                    </div>
                </div>
                
                <div style="flex: 1; min-width: 200px;">
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.setup_rate.id_for_label }}">Setup Rate (€):</label>
                        {{ form.setup_rate }}
                        {% if form.setup_rate.errors %}
                            <div style="color: red;">{{ form.setup_rate.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 200px;">
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.cleanup_time.id_for_label }}">Cleanup Time (minutes):</label>
                        {{ form.cleanup_time }}
                        {% if form.cleanup_time.errors %}
                            <div style="color: red;">{{ form.cleanup_time.errors }}</div>
                        {% endif %}
                    </div>
                </div>
                
                <div style="flex: 1; min-width: 200px;">
                    <div style="margin-bottom: 1rem;">
                        <label for="{{ form.cleanup_rate.id_for_label }}">Cleanup Rate (€):</label>
                        {{ form.cleanup_rate }}
                        {% if form.cleanup_rate.errors %}
                            <div style="color: red;">{{ form.cleanup_rate.errors }}</div>
                        {% endif %}
                    </div>
                </div>
                
                <div style="flex: 1; min-width: 200px;">
                    <!-- Spacer to balance the layout -->
                </div>
            </div>
            
            <h3>Notes</h3>
            <div style="margin-bottom: 1rem;">
                <label for="{{ form.notes.id_for_label }}">Additional Notes:</label>
                {{ form.notes }}
                {% if form.notes.help_text %}
                    <div style="font-size: 0.8rem; color: #666;">{{ form.notes.help_text }}</div>
                {% endif %}
                {% if form.notes.errors %}
                    <div style="color: red;">{{ form.notes.errors }}</div>
                {% endif %}
            </div>
            
            <div style="margin-top: 1rem; text-align: right;">
                <button type="submit" class="btn">Save Machine</button>
                <a href="{% if is_new %}{% url 'workshop_app:machine_list' %}{% else %}{% url 'workshop_app:machine_detail' machine.machine_id %}{% endif %}" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
{% endblock %}
